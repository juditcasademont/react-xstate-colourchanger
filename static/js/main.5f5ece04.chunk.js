(this["webpackJsonpxstate-react-typescript-template"]=this["webpackJsonpxstate-react-typescript-template"]||[]).push([[0],{29:function(t,e,o){},40:function(t,e,o){"use strict";o.r(e),o.d(e,"nluRequest",(function(){return f}));var n=o(26),a=o(7),r=(o(29),o(8),o(23)),s=o(20),i=o(2),c=o(44),p=o(43);function m(t){return Object(i.q)((e=>({type:"SPEAK",value:t})))}function d(){return Object(i.q)("LISTEN")}const l={John:{person:"John Appleseed"},Peter:{person:"Peter Pan"},Emma:{person:"Emma Watson"},Greta:{person:"Greta Thunberg"},"on Monday":{day:"Monday"},"on Tuesday":{day:"Tuesday"},"on Wednesday":{day:"Wednesday"},"on Thursday":{day:"Thursday"},"on Friday":{day:"Friday"},"on Saturday":{day:"Saturday"},"on Sunday":{day:"Sunday"},"at 10":{time:"10:00"},"at 8":{time:"8:00"},"at 7":{time:"7:00"},"at 4":{time:"4:00"},"at 5":{time:"5:00"},"at five":{time:"5:00"}},y={yes:{yes_no:!0},yep:{yes_no:!0},indeed:{yes_no:!0},"of course":{yes_no:!0},"yes please":{yes_no:!0},no:{yes_no:!1},nope:{yes_no:!1},"no way":{yes_no:!1},"absolutely not":{yes_no:!1},"not at all":{yes_no:!1}};m("Let's create an appointment"),Object(i.b)((t=>({person:l[t.recResult].person}))),m("Who are you meeting with?"),d(),m("Sorry I don't know them"),Object(i.b)((t=>({day:l[t.recResult].day}))),Object(i.q)((t=>({type:"SPEAK",value:"OK. Meeting ".concat(t.person,". On which day is your meeting?")}))),d(),m("Sorry I don't know what day this is"),Object(i.q)((t=>({type:"SPEAK",value:"OK. Meeting ".concat(t.person," on ").concat(t.day,". Will it take the whole day?")}))),d(),m("Sorry I don't understand"),Object(i.b)((t=>({time:l[t.recResult].time}))),Object(i.q)((t=>({type:"SPEAK",value:"OK. At what time is your meeting?"}))),d(),m("Sorry you will have to repeat that"),Object(i.q)((t=>({type:"SPEAK",value:"Do you want me to create an appointment with ".concat(t.person," on ").concat(t.day," for the whole day?")}))),d(),m("Sorry I didn't catch that"),Object(i.q)((t=>({type:"SPEAK",value:"Do you want me to create an appointment with ".concat(t.person," on ").concat(t.day," at ").concat(t.time,"?")}))),d(),m("Sorry I didn't catch that"),m("Your appointment has been created!");const u=o(11).a.cancel;function h(t){return Object(i.q)((e=>({type:"SPEAK",value:t})))}function g(t){return{initial:"prompt",states:{prompt:{entry:h(t),on:{ENDSPEECH:"ask"}},ask:{entry:[Object(i.q)("LISTEN"),Object(i.q)("MAX",{delay:5e3,id:"noMax"})]},nomatch:{entry:h("Sorry I didn't catch that"),on:{ENDSPEECH:"prompt"}}}}}const b={John:{person:"John Appleseed"},Peter:{person:"Peter Pan"},Emma:{person:"Emma Watson"},Greta:{person:"Greta Thunberg"},"on Monday":{day:"Monday"},"on Tuesday":{day:"Tuesday"},"on Wednesday":{day:"Wednesday"},"on Thursday":{day:"Thursday"},"on Friday":{day:"Friday"},"on Saturday":{day:"Saturday"},"on Sunday":{day:"Sunday"},"at 10":{time:"10:00"},"at 8":{time:"8:00"},"at 7":{time:"7:00"},"at 4":{time:"4:00"},"at 5":{time:"5:00"},"at five":{time:"5:00"}},O={yes:{yes_no:!0},yep:{yes_no:!0},indeed:{yes_no:!0},"of course":{yes_no:!0},"yes please":{yes_no:!0},no:{yes_no:!1},nope:{yes_no:!1},"no way":{yes_no:!1},"absolutely not":{yes_no:!1},"not at all":{yes_no:!1}};let E=0;const S={initial:"welcome",states:{init:{on:{CLICK:"welcome"}},welcome:{initial:"prompt",on:{ENDSPEECH:"askAppointment"},states:{prompt:{entry:h("Let's create an appointment")}}},askAppointment:{initial:"who",on:{RECOGNISED:{actions:Object(i.b)((t=>({counter:0})))}},states:{hist:{type:"history",history:"deep"},who:Object(a.a)({on:{RECOGNISED:[{cond:t=>"help"===t.recResult,target:"#root.dm.appointment.helper_who"},{cond:t=>"person"in(b[t.recResult]||{}),actions:[Object(i.b)((t=>({person:b[t.recResult].person}))),u("noMax")],target:"day"},{target:".nomatch",actions:u("noMax")}],MAX:[{cond:()=>E++<=2,target:"#root.dm.appointment.max"},{target:"#root.dm.appointment.maxFinal"}]}},g("Who are you meeting with?")),day:Object(a.a)({on:{RECOGNISED:[{cond:t=>"help"===t.recResult,target:"#root.dm.appointment.helper_day"},{cond:t=>"day"in(b[t.recResult]||{}),actions:[Object(i.b)((t=>({day:b[t.recResult].day}))),u("noMax")],target:"whole_day"},{target:".nomatch",actions:u("noMax")}],MAX:[{cond:()=>E++<=2,target:"#root.dm.appointment.max"},{target:"#root.dm.appointment.maxFinal"}]}},g("OK. On which day is your meeting?")),whole_day:Object(a.a)({on:{RECOGNISED:[{cond:t=>"help"===t.recResult,target:"#root.dm.appointment.helper_whole_day"},{cond:t=>!!O[t.recResult]&&!0===O[t.recResult].yes_no,actions:[u("noMax")],target:"confirmation_whole_day"},{cond:t=>!!O[t.recResult]&&!1===O[t.recResult].yes_no,actions:[u("noMax")],target:"time"},{target:".nomatch",actions:u("noMax")}],MAX:[{cond:()=>E++<=2,target:"#root.dm.appointment.max"},{target:"#root.dm.appointment.maxFinal"}]}},g("OK. Will your meeting take the whole day?")),time:Object(a.a)({on:{RECOGNISED:[{cond:t=>"help"===t.recResult,target:"#root.dm.appointment.helper_time"},{cond:t=>"time"in(b[t.recResult]||{}),actions:[Object(i.b)((t=>({time:b[t.recResult].time}))),u("noMax")],target:"confirmation_with_time"},{target:".nomatch",actions:u("noMax")}],MAX:[{cond:()=>E++<=2,target:"#root.dm.appointment.max"},{target:"#root.dm.appointment.maxFinal"}]}},g("OK. At what time is your meeting?")),confirmation_whole_day:Object(a.a)({on:{RECOGNISED:[{cond:t=>"help"===t.recResult,target:"#root.dm.appointment.helper_confs"},{cond:t=>!!O[t.recResult]&&!0===O[t.recResult].yes_no,actions:[u("noMax")],target:"appointment_created"},{cond:t=>!!O[t.recResult]&&!1===O[t.recResult].yes_no,actions:[u("noMax")],target:"who"},{target:".nomatch",actions:u("noMax")}],MAX:[{cond:()=>E++<=2,target:"#root.dm.appointment.max"},{target:"#root.dm.appointment.maxFinal"}]}},g("OK. Do you want me to create an appointment for the whole day?")),confirmation_with_time:Object(a.a)({on:{RECOGNISED:[{cond:t=>"help"===t.recResult,target:"#root.dm.appointment.helper_confs"},{cond:t=>!!O[t.recResult]&&!0===O[t.recResult].yes_no,actions:[u("noMax")],target:"appointment_created"},{cond:t=>!!O[t.recResult]&&!1===O[t.recResult].yes_no,actions:[u("noMax")],target:"who"},{target:".nomatch",actions:u("noMax")}],MAX:[{cond:()=>E++<=2,target:"#root.dm.appointment.max"},{target:"#root.dm.appointment.maxFinal"}]}},g("OK. Do you want me to create this appointment?")),appointment_created:{initial:"prompt",states:{prompt:{entry:h("Your appointment has been created!")}}}}},max:{entry:h("Sorry, I didn't hear anything"),on:{ENDSPEECH:{target:"#root.dm.appointment.askAppointment.hist"}}},maxFinal:{entry:h("Alright, since you don't wanna talk to me I'm gonna go to sleep"),always:"#root.dm.init"},helper_who:{entry:h("I need to know what person you'll be meeting. For example, you could say Peter... so who are you meeting with?"),on:{ENDSPEECH:"#root.dm.appointment.askAppointment.hist"}},helper_day:{entry:h("I'm looking for a day of the week here. For example, you could say on Wednesday... so on which day is your meeting?"),on:{ENDSPEECH:"#root.dm.appointment.askAppointment.hist"}},helper_whole_day:{entry:h("I'm asking if you will spend an entire day at the meeting. Your answer could be yes or no... so will it take the whole day?"),on:{ENDSPEECH:"#root.dm.appointment.askAppointment.hist"}},helper_time:{entry:h("I'm looking for a time to set your meeting. For example, you could say at ten... so at what time is your meeting?"),on:{ENDSPEECH:"#root.dm.appointment.askAppointment.hist"}},helper_confs:{entry:h("I'm making sure if I got the information correct. If I got it right, you can say yes... so do you want me to create the appointment?"),on:{ENDSPEECH:"#root.dm.appointment.askAppointment.hist"}}}};const w={initial:"init",states:{init:{on:{CLICK:"welcome"}},welcome:Object(a.a)({on:{RECOGNISED:{target:"invocation",actions:Object(i.b)((t=>({utterance:t.recResult})))}}},(j="What would you like to do?",{initial:"prompt",states:{prompt:{entry:m(j),on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")}}})),invocation:{invoke:{id:"whatever",src:(t,e)=>{return o=t.utterance,fetch(new Request("https://cors-anywhere.herokuapp.com/https://appointmentofpanic.herokuapp.com/model/parse",{method:"POST",headers:{Origin:"http://maraev.me"},body:'{"text": "'.concat(o,'"}')})).then((t=>t.json()));var o},onDone:{target:"choose",actions:[Object(i.b)(((t,e)=>({rasa_guess:e.data.intent.name}))),(t,e)=>console.log(e.data)]},onError:{target:"welcome",actions:(t,e)=>console.log(e.data)}}},choose:{entry:Object(i.q)("RECOGNISED"),on:{RECOGNISED:[{target:"appointment",cond:t=>"appointment"===t.rasa_guess},{target:"todo",cond:t=>"TODO_list"===t.rasa_guess},{target:"timer",cond:t=>"timer"===t.rasa_guess}]}},appointment:Object(a.a)({},S),todo:{initial:"prompt",states:{prompt:{entry:m("Let's write a todo list")}}},timer:{initial:"prompt",states:{prompt:{entry:m("Let's set a timer")}}}}};var j,R=o(22),_=o(13);Object(p.a)({url:"https://statecharts.io/inspect",iframe:!1});const x=Object(s.a)({id:"root",type:"parallel",states:{dm:Object(a.a)({},w),asrtts:{initial:"idle",states:{idle:{on:{LISTEN:"recognising",SPEAK:{target:"speaking",actions:Object(i.b)(((t,e)=>({ttsAgenda:e.value})))}}},recognising:{entry:"recStart",exit:"recStop",on:{ASRRESULT:{actions:["recLogResult",Object(i.b)(((t,e)=>({recResult:e.value})))],target:".match"},RECOGNISED:"idle",MAX:"idle"},states:{match:{entry:Object(i.q)("RECOGNISED")}}},speaking:{entry:"ttsStart",on:{ENDSPEECH:"idle"}}}}}},{actions:{recLogResult:t=>{console.log("<< ASR: "+t.recResult)},test:()=>{console.log("test")},logIntent:t=>{console.log("<< NLU intent: "+t.nluData.intent.name)}}}),k=t=>{switch(!0){case t.state.matches({asrtts:"recognising"}):return Object(_.jsx)("button",Object(a.a)(Object(a.a)({type:"button",className:"glow-on-hover",style:{animation:"glowing 20s linear"}},t),{},{children:"Listening..."}));case t.state.matches({asrtts:"speaking"}):return Object(_.jsx)("button",Object(a.a)(Object(a.a)({type:"button",className:"glow-on-hover",style:{animation:"bordering 1s infinite"}},t),{},{children:"Speaking..."}));default:return Object(_.jsx)("button",Object(a.a)(Object(a.a)({type:"button",className:"glow-on-hover"},t),{},{children:"Click to start"}))}};function I(){const t=Object(R.useSpeechSynthesis)({onEnd:()=>{d("ENDSPEECH")}}),e=t.speak,o=t.cancel,a=(t.speaking,Object(R.useSpeechRecognition)({onResult:t=>{d({type:"ASRRESULT",value:t})}})),r=a.listen,s=(a.listening,a.stop),i=Object(c.b)(x,{devTools:!0,actions:{recStart:Object(c.a)((()=>{console.log("Ready to receive a color command."),r({interimResults:!1,continuous:!0})})),recStop:Object(c.a)((()=>{console.log("Recognition stopped."),s()})),changeColour:Object(c.a)((t=>{console.log("Repainting..."),document.body.style.background=t.recResult})),ttsStart:Object(c.a)(((t,o)=>{console.log("Speaking..."),e({text:t.ttsAgenda})})),ttsCancel:Object(c.a)(((t,e)=>{console.log("TTS STOP..."),o()}))}}),p=Object(n.a)(i,3),m=p[0],d=p[1];p[2];return Object(_.jsx)("div",{className:"App",children:Object(_.jsx)(k,{state:m,onClick:()=>d("CLICK")})})}const f=t=>fetch(new Request("https://cors-anywhere.herokuapp.com/https://appointmentofpanic.herokuapp.com/model/parse",{method:"POST",headers:{Origin:"http://maraev.me"},body:'{"text": "'.concat(t,'"}')})).then((t=>t.json())),A=document.getElementById("root");r.render(Object(_.jsx)(I,{}),A)}},[[40,1,2]]]);
//# sourceMappingURL=main.5f5ece04.chunk.js.map